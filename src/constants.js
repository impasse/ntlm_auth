const NTLM_SIGNATURE = Buffer.from('NTLMSSP\0', 'ascii');

const MessageTypes = {
    NTLM_NEGOTIATE: 0x1,
    NTLM_CHALLENGE: 0x2,
    NTLM_AUTHENTICATE: 0x3,
};

const AvFlags = {
    AUTHENTICATION_CONSTRAINED: 0x1,
    MIC_PROVIDED: 0x2,
    UNTRUSTED_SPN_SOURCE: 0x4,
};

const NegotiateFlags = {
    NTLMSSP_NEGOTIATE_56: 0x80000000,
    NTLMSSP_NEGOTIATE_KEY_EXCH: 0x40000000,
    NTLMSSP_NEGOTIATE_128: 0x20000000,
    NTLMSSP_RESERVED_R1: 0x10000000,
    NTLMSSP_RESERVED_R2: 0x08000000,
    NTLMSSP_RESERVED_R3: 0x04000000,
    NTLMSSP_NEGOTIATE_VERSION: 0x02000000,
    NTLMSSP_RESERVED_R4: 0x01000000,
    NTLMSSP_NEGOTIATE_TARGET_INFO: 0x00800000,
    NTLMSSP_REQUEST_NON_NT_SESSION_KEY: 0x00400000,
    NTLMSSP_RESERVED_R5: 0x00200000,
    NTLMSSP_NEGOTIATE_IDENTITY: 0x00100000,
    NTLMSSP_NEGOTIATE_EXTENDED_SESSIONSECURITY: 0x00080000,
    NTLMSSP_RESERVED_R6: 0x00040000,
    NTLMSSP_TARGET_TYPE_SERVER: 0x00020000,
    NTLMSSP_TARGET_TYPE_DOMAIN: 0x00010000,
    NTLMSSP_NEGOTIATE_ALWAYS_SIGN: 0x00008000,
    NTLMSSP_RESERVED_R7: 0x00004000,
    NTLMSSP_NEGOTIATE_OEM_WORKSTATION_SUPPLIED: 0x00002000,
    NTLMSSP_NEGOTIATE_OEM_DOMAIN_SUPPLIED: 0x00001000,
    NTLMSSP_ANOYNMOUS: 0x00000800,
    NTLMSSP_RESERVED_R8: 0x00000400,
    NTLMSSP_NEGOTIATE_NTLM: 0x00000200,
    NTLMSSP_RESERVED_R9: 0x00000100,
    NTLMSSP_NEGOTIATE_LM_KEY: 0x00000080,
    NTLMSSP_NEGOTIATE_DATAGRAM: 0x00000040,
    NTLMSSP_NEGOTIATE_SEAL: 0x00000020,
    NTLMSSP_NEGOTIATE_SIGN: 0x00000010,
    NTLMSSP_RESERVED_R10: 0x00000008,
    NTLMSSP_REQUEST_TARGET: 0x00000004,
    NTLMSSP_NEGOTIATE_OEM: 0x00000002,
    NTLMSSP_NEGOTIATE_UNICODE: 0x00000001,
};

const SignSealConstants = {
    CLIENT_SIGNING: "session key to client-to-server signing key magic constant\0",
    SERVER_SIGNING: "session key to server-to-client signing key magic constant\0",
    CLIENT_SEALING: "session key to client-to-server sealing key magic constant\0",
    SERVER_SEALING: "session key to server-to-client sealing key magic constant\0",
};

module.exports = {
    NTLM_SIGNATURE,
    MessageTypes,
    AvFlags,
    NegotiateFlags,
    SignSealConstants,
}
